<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ssh | A D Vishnu Prasad]]></title>
  <link href="http://advishnuprasad.github.io/blog/categories/ssh/atom.xml" rel="self"/>
  <link href="http://advishnuprasad.github.io/"/>
  <updated>2016-03-25T21:35:30+05:30</updated>
  <id>http://advishnuprasad.github.io/</id>
  <author>
    <name><![CDATA[A D Vishnu Prasad]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Provide Ssh Access to User Using Ansible]]></title>
    <link href="http://advishnuprasad.github.io/blog/2016/02/11/add-user/"/>
    <updated>2016-02-11T19:42:30+05:30</updated>
    <id>http://advishnuprasad.github.io/blog/2016/02/11/add-user</id>
    <content type="html"><![CDATA[<h3>How to provide production server access to users using ansible?</h3>

<h4>Assumptions:</h4>

<p>  You have  ssh access to prod servers as Ubuntu user.</p>

<h5>Ansible Script for adding user</h5>

<pre><code class="yml add_user.yml"># ansible-playbook add_user.yml --extra-vars "user=advp key=advp.pub" -i ad
---
- hosts: all
  remote_user: ubuntu
  become: True
  become_method: sudo
  become_user: root

  tasks:
    - name: Add user
      user:
            name="{ user }"
            shell=/bin/bash
            state=present
            groups=staff
            append=yes
            createhome=yes
            password=&lt;password SALT&gt;
            update_password=on_create

    - name: Add keys to the users
      authorized_key:
        key="{ lookup('file', '{ key }') }"
        user="{ user }"
        state=present
</code></pre>

<p>Replace <code>{</code> with double <code>{</code> in the above script.</p>

<h4>Add a single user:</h4>

<pre><code class="bash">ansible-playbook add_user.yml --extra-vars "user=advp key=&lt;user/pub/key/path&gt;"  -i inventory/ad
</code></pre>

<p>don&rsquo;t forget to change the user and key location in the above command.</p>
]]></content>
  </entry>
  
</feed>
